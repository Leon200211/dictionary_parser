# Dictionary Parser - Парсер словарных статей

Парсер для обработки словарных статей из Word документов с поддержкой специальных тегов разметки.

## Возможности

- Парсинг Word документов (.docx) с извлечением словарных статей
- Поддержка специальных тегов разметки (# ##, {1}, {2}, и т.д.)
- Обработка вложенных секций
- Извлечение вариантов написания слов
- Логирование ошибок и ссылочных статей
- Экспорт результатов в JSON формат

## Быстрый старт

### Предварительные требования

- Docker
- Docker Compose

### Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd dictionary_parser
```

2. Создайте необходимые директории:
```bash
mkdir -p input output logs
```

3. Поместите ваши Word документы (.docx) в папку `input/`

4. Запустите парсер через Docker Compose:
```bash
docker-compose up --build
```

Или для разового запуска:
```bash
docker-compose run --rm parser
```

## Структура проекта

```
dictionary_parser/
├── input/              # Входные Word документы
├── output/             # Выходные JSON файлы
├── logs/               # Логи (ошибки, ссылки)
├── parser.py           # Основной скрипт парсера
├── requirements.txt    # Python зависимости
├── Dockerfile          # Docker образ
├── docker-compose.yml  # Docker Compose конфигурация
└── README.md          # Документация
```

## Формат входных данных

### Поддерживаемые теги

- `#` ... `##` - начало и конец словарной статьи
- `{1}` ... `{1}` - заголовок статьи
- `{2}` ... `{2}` - грамматические пометы
- `{3}` ... `{3}` - толкования
- `{4}` ... `{4}` - произношение
- `{5}` ... `{5}` - грамматические формы
- `+6+` ... `+6+` - иллюстрации
- `{7}` ... `{7}` - словообразование
- `{8}` ... `{8}` - словарные фиксации
- `+9+` ... `+9+` - синонимы
- `+10+` ... `+10+` - антонимы
- `{11}` ... `{11}` - фразеология
- `{12}` ... `{12}` - морфемика
- `{13}` ... `{13}` - этимология

### Пример статьи

```
#{1}ааро́новский{1}##
#{1}аа́ленский{1} (от Аа́лен, геол.)##
#{1}автолизи́ровать(ся){1} {1}и аутолизи́ровать(ся){1}##
```

## Формат выходных данных

Результаты сохраняются в JSON формате:

```json
[
  {
    "writings": [
      {
        "word": "аароновский",
        "value": "ааро́новский"
      }
    ],
    "sections": [
      {
        "type": 1,
        "content": "<strong>ааро́новский</strong>",
        "sections": []
      }
    ]
  }
]
```

## Логирование

Парсер создает два типа лог-файлов в директории `logs/`:

- `errors.log` - ошибки парсинга
- `links.log` - ссылочные статьи (типа "См. Другое_слово")

## Локальная разработка

Для разработки без Docker:

```bash
# Создайте виртуальное окружение
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate  # Windows

# Установите зависимости
pip install -r requirements.txt

# Запустите парсер
python parser.py
```

## Настройка

Вы можете изменить пути к директориям в `parser.py`:

```python
parser = DictionaryParser(
    input_dir='/app/input',
    output_dir='/app/output',
    logs_dir='/app/logs'
)
```

Или через переменные окружения в `docker-compose.yml`:

```yaml
environment:
  - INPUT_DIR=/app/input
  - OUTPUT_DIR=/app/output
  - LOGS_DIR=/app/logs
```

## Особенности обработки

### Секция 1 (Заголовки)

- Слова сохраняются без лишних символов (только буквы и тире)
- Буква `ё` заменяется на `е`
- Все буквы приводятся к нижнему регистру
- Поддержка опциональных окончаний: `слово(ся)` → `слово`, `словося`
- Игнорирование числовых индексов (¹, ², ³)

### Ссылочные статьи

Статьи вида "СЛОВО. См. Другое_слово" не обрабатываются и сохраняются в `logs/links.log`

### Обработка ошибок

При обнаружении ошибок (вложенные статьи, незакрытые теги), парсер:
1. Логирует ошибку в `logs/errors.log`
2. Продолжает обработку следующих статей

## Примеры использования

### Обработка одного файла

```bash
# Поместите файл в input/
cp my_dictionary.docx input/

# Запустите парсер
docker-compose run --rm parser

# Результат будет в output/my_dictionary.json
```

### Обработка нескольких файлов

```bash
# Поместите все файлы в input/
cp *.docx input/

# Запустите парсер
docker-compose run --rm parser

# Результаты будут в output/ с соответствующими именами
```

## Поддержка

Для вопросов и предложений создавайте issue в репозитории проекта.

## Лицензия

MIT
